from numpy import *
from pylab import *

def ludecomp(b):
  a=b.copy()
  n=shape(a)[0]
  for k in xrange(0,n-1):
    a[k+1:,k]=a[k+1:,k]/a[k,k]
    a[k+1:,k+1:n]=a[k+1:,k+1:n] - dot(a[k+1:,k].reshape(-1,1,order = 'F'),a[k,k+1:n].reshape(1,-1, order = 'F'))
  return a

def getfactors(a):
  n=shape(a)[0]
  l=eye(n)
  u=zeros((n,n))
  for i in xrange(n):
    for j in xrange(i+1,n):
      u[i,j]=a[i,j]
      a[i,j]=0
  u=u+diag(diag(a))
  l=l+a-diag(diag(a))
  return l,uf


  
def back(a,f):
  n=shape(a)[0]
  b=f.copy()
  for i in xrange(n-1,1,-1):
    b[i]=b[i]/a[i,i]
    b[:i]=b[:i]-b[i]*a[:i,i]
  return b
